(this["webpackJsonpreact-burger"]=this["webpackJsonpreact-burger"]||[]).push([[0],{111:function(e,t,n){e.exports={orderContainer:"order-list_orderContainer__2Mbrc"}},112:function(e,t,n){e.exports={modalOverlay:"modal-overlay_modalOverlay__2RMl1"}},114:function(e,t,n){e.exports={ingredients:"ingredient-group_ingredients__38AI4"}},115:function(e,t,n){e.exports={container:"not-found_container__heFy6"}},116:function(e,t,n){e.exports={orderContainer:"order-list_orderContainer__35qQm"}},117:function(e,t,n){e.exports={container:"profile_container__L_OtZ"}},118:function(e,t,n){e.exports={container:"app_container__2GidD"}},19:function(e,t,n){e.exports={header:"header_header__v9FKw",nav:"header_nav__2M5Zj",item:"header_item__3wYrv",logo:"header_logo__1X7aW",link:"header_link__3CRBA",activeLink:"header_activeLink__1YFvn",navList:"header_navList__7Z9bB",brand:"header_brand__1d8Qj"}},212:function(e,t,n){"use strict";n.r(t);var r,c=n(1),a=n.n(c),s=n(40),i=n.n(s),o=n(49),u=n(7),d=n(5),l=n.n(d),j=n(15),b=n(10),O=n(4),p=n(14);!function(e){e.created="\u0421\u043e\u0437\u0434\u0430\u043d",e.pending="\u0413\u043e\u0442\u043e\u0432\u0438\u0442\u0441\u044f",e.done="\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d"}(r||(r={}));var m,f=r;!function(e){e.MAIN="/",e.FEED="/feed",e.FEED_VIEW="/feed/:id",e.LOGIN="/login",e.SIGNUP="/register",e.FORGOT_PASSWORD="/forgot-password",e.RESET_PASSWORD="/reset-password",e.PROFILE="/profile",e.PROFILE_ORDER_LIST="/profile/orders",e.PROFILE_ORDER_VIEW="/profile/orders/:id",e.INGREDIENT_VIEW="/ingredient/:id"}(m||(m={}));var _,x=m;!function(e){e.MAIN="main",e.SAUCE="sauce",e.BUN="bun"}(_||(_={}));var h=_,v=n(6),g=n.n(v),E=n(13),y="SET_ERROR",N="FETCH_INGREDIENTS_SUCCESS",S="FETCH_INGREDIENTS_ERROR",R="RESET_ERROR",I="ADD_INGREDIENT_TO_ORDER",k="REMOVE_INGREDIENT_FROM_ORDER",T="RESET_CURRENT_ORDER",w="MOVE_INGREDIENTS",C="SET_NUMBER",D="TOGGLE_MODAL",L="SET_INGREDIENT",F="RESET_INGREDIENT",P="CREATE_ORDER_SUCCESS",U="CREATE_ORDER_ERROR",G="SET_ORDER_HISTORY",A="SET_ORDER_SUCCESS",M="PASSWORD_RESET_SUCCESS",B="PASSWORD_RESET_ERROR",W="CONFIRM_PASSWORD_RESET_SUCCESS",H="CONFIRM_PASSWORD_RESET_ERROR",V="SOCKET_OPEN",J="SOCKET_CLOSE",Q="FETCH_USER_SUCCESS",q="UPDATE_USER_SUCCESS",Z="LOGIN_SUCCESS",z="LOGIN_ERROR",X="LOGOUT_SUCCESS",K="SIGNUP_SUCCESS",Y=function(e){return{type:D,value:e}},$=function(){return Object(o.b)()},ee=o.c,te=n(2),ne=n(35),re=n.n(ne),ce=n(221),ae=n(107),se=n.n(ae),ie=n(108),oe=n.n(ie),ue=n(109),de=n.n(ue);n(207);re.a.extend(oe.a),re.a.extend(de.a),re.a.extend(se.a),re.a.locale("ru");var le=function(e,t){var n;switch(t){case"top":n="".concat(e.name," (\u0432\u0435\u0440\u0445)");break;case"bottom":n="".concat(e.name," (\u043d\u0438\u0437)");break;default:n=e.name}return{id:e._id,uniqueId:Object(ce.a)(),type:e.type,position:t,text:n,isLocked:e.type===h.BUN,price:e.price,thumbnail:e.image}},je=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(n=Object(te.a)({path:"/"},n)).expires instanceof Date&&(n.expires=n.expires.toUTCString());var r=encodeURIComponent(e)+"="+encodeURIComponent(t);for(var c in n){r+="; "+c;var a=n[c];!0!==a&&(r+="="+a)}document.cookie=r},be=function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([.$?*|{}()[\]\\/+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0},Oe=function(e){var t=re()(e),n=t.format("Z").split(":")[0].replace("0",""),r="".concat(t.format("HH:mm")," i-GMT").concat(n);return t.isToday()?"\u0421\u0435\u0433\u043e\u0434\u043d\u044f, ".concat(r):t.isYesterday()?"\u0412\u0447\u0435\u0440\u0430, ".concat(r):"".concat(t.fromNow(),", ").concat(r)},pe=n(24),me=n.n(pe),fe=n(0),_e=function(e){var t=e.order,n=e.route,r=Object(p.g)(),a=$(),s=Object(p.h)(),i=ee((function(e){return e.app.ingredients})),o=t.ingredients.filter((function(e){return e})).map((function(e){var t=i.find((function(t){return t._id===e}));return{url:t.image_mobile,id:t._id,price:t.price}})),u=Object(c.useMemo)((function(){return Oe(t.createdAt)}),[t.createdAt]),d=Object(c.useMemo)((function(){return o.reduce((function(e,t){return e+t.price}),0)}),[o]),l=Object(c.useMemo)((function(){return o.length}),[o]),j=Object(c.useMemo)((function(){return f[t.status]===f.done}),[t.status]),b=Object(c.useCallback)((function(){a(Y(!0)),r.replace({pathname:n.replace(/:id/,"".concat(t.number)),state:{modal:s}})}),[a,r,s,t.number,n]);return Object(fe.jsxs)("div",{className:me.a.order,onClick:b,children:[Object(fe.jsxs)("div",{className:me.a.header,children:[Object(fe.jsxs)("span",{children:["#",t.number]}),Object(fe.jsx)("span",{className:me.a.created,children:u})]}),Object(fe.jsxs)("div",{children:[Object(fe.jsx)("div",{className:me.a.title,children:t.name}),Object(fe.jsx)("div",{className:g()(Object(E.a)({},me.a.done,j)),children:f[t.status]})]}),Object(fe.jsxs)("div",{className:me.a.receipt,children:[Object(fe.jsxs)("div",{className:me.a.ingredients,children:[o.slice(0,5).map((function(e,t){return Object(fe.jsx)("div",{className:me.a.imgBlock,style:{left:"".concat(48*t,"px"),zIndex:5-t},children:Object(fe.jsx)("img",{src:e.url,alt:e.id})},"".concat(e.id,"-").concat(t))})),l>5&&Object(fe.jsxs)("div",{className:g()(me.a.imgBlock,me.a.more),style:{left:"".concat(240,"px")},children:[Object(fe.jsx)("img",{src:o[5].url,alt:o[5].id}),Object(fe.jsxs)("span",{className:me.a.quantity,children:["+",l-5]})]},"".concat(o[5].id,"-more"))]}),Object(fe.jsxs)("div",{className:g()(me.a.cost,"text","text_type_digits-default"),children:[d,Object(fe.jsx)(O.CurrencyIcon,{type:"primary"})]})]})]})},xe=n(111),he=n.n(xe),ve=function(e){var t=e.orders,n=e.className,r=e.route;return Object(fe.jsx)("div",{className:g()(he.a.orderContainer,n),children:t.map((function(e){return Object(fe.jsx)(_e,{order:e,route:r},e.number)}))})},ge="https://norma.nomoreparties.space/api/",Ee=function(e){return{type:y,error:e}},ye=function(e){return{type:G,data:e}},Ne=function(e,t){var n=Object(c.useRef)(),r=$();Object(c.useEffect)((function(){return n.current=new WebSocket("".concat("wss://norma.nomoreparties.space/").concat(e)),function(){var e;null===(e=n.current)||void 0===e||e.close()}}),[e]),Object(c.useEffect)((function(){n.current&&(n.current.addEventListener("close",(function(){r({type:J})})),n.current.addEventListener("open",(function(){r({type:V})})),n.current.addEventListener("message",(function(e){var n=e.data;r(t(JSON.parse(n)))})))}),[n,r,t])},Se=n(27),Re=n.n(Se),Ie=function(e,t){return e.number>t.number?-1:e.number<t.number?1:0},ke=function(e,t){return e.filter((function(e){return f[e.status]===t})).map((function(e){return e.number})).slice(0,30)},Te=function(){Ne("orders/all",ye);var e=ee((function(e){return e.orderHistory})),t=Object(c.useMemo)((function(){return e.orders.sort(Ie)}),[e.orders]),n=Object(c.useMemo)((function(){return ke(t,f.pending)}),[t]),r=Object(c.useMemo)((function(){return ke(t,f.done)}),[t]);return Object(fe.jsxs)("div",{children:[Object(fe.jsx)("h1",{children:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432"}),Object(fe.jsxs)("div",{className:Re.a.feed,children:[Object(fe.jsx)(ve,{orders:t,className:Re.a.orderList,route:x.FEED_VIEW}),Object(fe.jsxs)("div",{className:Re.a.stats,children:[Object(fe.jsxs)("div",{className:Re.a.ordersByStatus,children:[Object(fe.jsxs)("div",{children:[Object(fe.jsx)("h2",{children:"\u0413\u043e\u0442\u043e\u0432\u044b"}),Object(fe.jsx)("div",{className:Re.a.numberList,children:r.map((function(e){return Object(fe.jsx)("div",{className:g()(Re.a.done,"text","text_type_digits-default"),children:e},e)}))})]}),Object(fe.jsxs)("div",{children:[Object(fe.jsx)("h2",{children:"\u0412 \u0440\u0430\u0431\u043e\u0442\u0435"}),Object(fe.jsx)("div",{className:Re.a.numberList,children:n.map((function(e){return Object(fe.jsx)("span",{className:g()("text","text_type_digits-default"),children:e},e)}))})]})]}),Object(fe.jsxs)("div",{children:[Object(fe.jsx)("h2",{className:Re.a.counterTitle,children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u0437\u0430 \u0432\u0441\u0451 \u0432\u0440\u0435\u043c\u044f"}),Object(fe.jsx)("span",{className:g()(Re.a.counter,"text","text_type_digits-default"),children:e.total})]}),Object(fe.jsxs)("div",{children:[Object(fe.jsx)("h2",{className:Re.a.counterTitle,children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u0437\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f"}),Object(fe.jsx)("span",{className:g()(Re.a.counter,"text","text_type_digits-default"),children:e.totalToday})]})]})]})]})},we=function(e){return function(){var t=Object(j.a)(l.a.mark((function t(n){var r,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n({type:"CONFIRM_PASSWORD_RESET_REQUEST"}),t.next=4,fetch("".concat(ge,"password-reset/reset"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});case 4:if((r=t.sent).ok){t.next=7;break}throw new Error("Error: ".concat(r.status));case 7:return t.next=9,r.json();case 9:if(c=t.sent,c.success){t.next=13;break}throw new Error("Failed parse data");case 13:n({type:W}),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(0),n({type:H}),t.t0 instanceof Error&&n(Ee(t.t0.message));case 20:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(e){return t.apply(this,arguments)}}()},Ce=(n(44),n(8)),De=n.n(Ce),Le=function(){var e=$(),t=Object(p.g)(),n=Object(p.h)().pathname,r=ee((function(e){return e.resetPassword})).isSendForgotPassword,a=Object(c.useState)(""),s=Object(b.a)(a,2),i=s[0],o=s[1];return Object(c.useEffect)((function(){r&&t.replace({pathname:x.RESET_PASSWORD,state:{from:n}})}),[r,t,n]),Object(fe.jsx)("div",{className:De.a.container,children:Object(fe.jsxs)("div",{className:De.a.login,children:[Object(fe.jsx)("div",{className:"text_type_main-medium",children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f"}),Object(fe.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e(function(e){return function(){var t=Object(j.a)(l.a.mark((function t(n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n({type:"PASSWORD_RESET_REQUEST"}),t.next=4,fetch("".concat(ge,"password-reset"),{method:"POST",body:JSON.stringify({email:e}),headers:{"Content-Type":"application/json"}});case 4:if((r=t.sent).ok){t.next=7;break}throw new Error("Error: ".concat(r.status));case 7:return t.next=9,r.json();case 9:if(t.sent.success){t.next=13;break}throw new Error("Failed parse data");case 13:n({type:M}),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(0),n({type:B}),t.t0 instanceof Error&&n(Ee(t.t0.message));case 20:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(e){return t.apply(this,arguments)}}()}(i))},children:[Object(fe.jsx)("div",{className:De.a.input,children:Object(fe.jsx)(O.EmailInput,{value:i,name:"email",onChange:function(e){o(e.target.value)}})}),Object(fe.jsx)("div",{className:De.a.btnLogin,children:Object(fe.jsx)(O.Button,{type:"primary",size:"large",children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c"})})]}),Object(fe.jsxs)("div",{className:De.a.firstLine,children:[Object(fe.jsx)("span",{children:"\u0412\u0441\u043f\u043e\u043c\u043d\u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?"}),Object(fe.jsx)(u.b,{to:"".concat(x.LOGIN),children:"\u0412\u043e\u0439\u0442\u0438"})]})]})})},Fe=n(29),Pe=n.n(Fe);var Ue=function(){var e=Object(p.i)().id,t=Object(p.h)(),n=t.state&&t.state.modal,r=ee((function(e){return e.app})).ingredients,a=Object(c.useMemo)((function(){return r.find((function(t){return t._id===e}))}),[e,r]);if(!a)return Object(fe.jsx)(fe.Fragment,{});var s=[{name:"\u041a\u0430\u043b\u043e\u0440\u0438\u0438, \u043a\u043a\u0430\u043b",value:a.calories},{name:"\u0411\u0435\u043b\u043a\u0438, \u0433",value:a.proteins},{name:"\u0416\u0438\u0440\u044b, \u0433",value:a.fat},{name:"\u0423\u0433\u043b\u0435\u0432\u043e\u0434\u044b, \u0433",value:a.carbohydrates}];return Object(fe.jsxs)("div",{className:g()(Pe.a.content,Object(E.a)({},Pe.a.page,!n)),children:[Object(fe.jsx)("h1",{className:Pe.a.header,children:"\u0414\u0435\u0442\u0430\u043b\u0438 \u0438\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u0430"}),Object(fe.jsxs)("div",{className:Pe.a.body,children:[Object(fe.jsx)("img",{className:Pe.a.img,src:a.image_large,alt:a.name}),Object(fe.jsx)("h2",{className:Pe.a.name,children:a.name}),Object(fe.jsx)("div",{className:Pe.a.composition,children:s.map((function(e,t){return Object(fe.jsxs)("div",{className:"".concat(Pe.a.compositionItem," text_color_inactive"),children:[Object(fe.jsx)("span",{children:e.name}),Object(fe.jsx)("span",{className:"".concat(Pe.a.compositionValue," text text_type_digits-medium"),children:e.value})]},t)}))})]})]})},Ge=function(){var e=Object(p.i)(),t=$(),n=ee((function(e){return e.app})).ingredients,r=Object(c.useState)(),a=Object(b.a)(r,2),s=a[0],i=a[1];return Object(c.useEffect)((function(){return i(n.find((function(t){return t._id===e.id}))),n.length&&!s&&t({type:y,error:"\u0418\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442 \u0441 \u0442\u0430\u043a\u0438\u043c ID \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"}),function(){t({type:R})}}),[n,s,t,e.id]),Object(fe.jsx)("div",{children:s?Object(fe.jsx)(Ue,{}):Object(fe.jsx)(fe.Fragment,{})})},Ae=function(e,t){localStorage.setItem("refreshToken",t),je("accessToken",e.split(" ")[1],{"max-age":1200})},Me=function(){localStorage.removeItem("refreshToken"),je("accessToken","",{"max-age":-1})},Be=function(){var e=Object(j.a)(l.a.mark((function e(t){var n,r,c,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(ge,"auth/token"),{method:"POST",body:JSON.stringify({token:t}),headers:{"Content-Type":"application/json"}});case 2:if((n=e.sent).ok){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,n.json();case 7:if(r=e.sent,c=r.success,a=r.refreshToken,s=r.accessToken,c){e.next=13;break}throw new Error("Failed updating token");case 13:Ae(s,a);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),We=function(e){return{type:Z,user:e}},He=function(e){return{type:K,user:e}},Ve=function(e){return{type:Q,user:Object(te.a)(Object(te.a)({},e),{},{password:""})}},Je=function(e){return{type:q,user:Object(te.a)(Object(te.a)({},e),{},{password:""})}},Qe=function(){var e=$(),t=Object(c.useState)({email:"",password:""}),n=Object(b.a)(t,2),r=n[0],a=n[1],s=function(e){var t=e.target,n=t.name,c=t.value;a(Object(te.a)(Object(te.a)({},r),{},Object(E.a)({},n,c)))};return Object(fe.jsx)("div",{className:De.a.container,children:Object(fe.jsxs)("div",{className:De.a.login,children:[Object(fe.jsx)("div",{className:"text_type_main-medium",children:"\u0412\u0445\u043e\u0434"}),Object(fe.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e(function(e){return function(){var t=Object(j.a)(l.a.mark((function t(n){var r,c,a,s,i,o,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n({type:"LOGIN_REQUEST"}),t.next=4,fetch("".concat(ge,"auth/login"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});case 4:if((r=t.sent).ok){t.next=10;break}return t.next=8,r.json();case 8:throw c=t.sent,new Error("Error: ".concat(c.message));case 10:return t.next=12,r.json();case 12:if(a=t.sent,s=a.success,i=a.user,o=a.accessToken,u=a.refreshToken,s){t.next=19;break}throw new Error("Failed login");case 19:Ae(o,u),n(We(i)),t.next=27;break;case 23:t.prev=23,t.t0=t.catch(0),n({type:z}),t.t0 instanceof Error&&n(Ee(t.t0.message));case 27:case"end":return t.stop()}}),t,null,[[0,23]])})));return function(e){return t.apply(this,arguments)}}()}(r))},children:[Object(fe.jsx)("div",{className:De.a.input,children:Object(fe.jsx)(O.EmailInput,{onChange:s,value:r.email,name:"email"})}),Object(fe.jsx)("div",{className:De.a.input,children:Object(fe.jsx)(O.PasswordInput,{onChange:s,value:r.password,name:"password"})}),Object(fe.jsx)("div",{className:De.a.btnLogin,children:Object(fe.jsx)(O.Button,{type:"primary",size:"large",children:"\u0412\u043e\u0439\u0442\u0438"})})]}),Object(fe.jsxs)("div",{className:De.a.firstLine,children:[Object(fe.jsx)("span",{children:"\u0412\u044b \u2013 \u043d\u043e\u0432\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c?"}),Object(fe.jsx)(u.b,{to:x.SIGNUP,children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]}),Object(fe.jsxs)("div",{className:De.a.secondLine,children:[Object(fe.jsx)("span",{children:"\u0417\u0430\u0431\u044b\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?"}),Object(fe.jsx)(u.b,{to:x.FORGOT_PASSWORD,children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c"})]})]})})},qe=n(218),Ze=n(120),ze=n(220),Xe=function(e,t){return{type:I,value:le(e,t)}},Ke=function(e){return{type:P,order:e}},Ye=n(50),$e=n.n(Ye),et=n(112),tt=n.n(et);var nt=function(){return Object(fe.jsx)("div",{className:tt.a.modalOverlay})},rt=document.getElementById("modals"),ct=function(e){var t=e.onClose,n=e.children,r=Object(c.useRef)(null);return Object(c.useEffect)((function(){var e=function(e){"Escape"===e.code&&t()},n=function(e){r.current&&!r.current.contains(e.target)&&t()};return document.addEventListener("keyup",e),document.addEventListener("click",n),function(){document.removeEventListener("keyup",e),document.removeEventListener("click",n)}}),[t]),Object(s.createPortal)(Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)("div",{className:"".concat($e.a.modal," text_type_main-default"),children:Object(fe.jsx)("div",{ref:r,className:$e.a.modalDialog,children:Object(fe.jsxs)("div",{className:$e.a.modalContent,children:[Object(fe.jsx)("span",{className:$e.a.closeButton,children:Object(fe.jsx)(O.CloseIcon,{type:"primary",onClick:t})}),n]})})}),Object(fe.jsx)(nt,{})]}),rt)},at=n(36),st=n.n(at),it=n(219),ot=n(61),ut=n.n(ot),dt=function(e){var t=$(),n=Object(c.useRef)(null),r=Object(it.a)((function(){return{type:"moveIngredient",item:{index:e.index},collect:function(e){return{isDragging:e.isDragging()}}}}),[e.index]),a=Object(b.a)(r,2),s=a[0].isDragging,i=a[1],o=Object(ze.a)({accept:"moveIngredient",hover:function(e){return j(e)}}),u=Object(b.a)(o,2)[1],d=e.type===h.BUN,l=s?0:1,j=function(r){if(n.current){var c=r.index,a=e.index;c!==a&&(t(function(e,t){return{type:w,dragIndex:e,hoverIndex:t}}(c,a)),r.index=a)}};return i(u(n)),Object(fe.jsxs)("div",Object(te.a)(Object(te.a)({},d?{}:{ref:n}),{},{style:{opacity:l},className:g()([ut.a.item,Object(E.a)({},ut.a.bun,d)]),children:[Object(fe.jsx)("div",{className:ut.a.icon,children:!d&&Object(fe.jsx)(O.DragIcon,{type:"primary"})}),Object(fe.jsx)(O.ConstructorElement,Object(te.a)(Object(te.a)({},e),{},{type:e.position,handleClose:function(){var n;d||t((n=e.uniqueId,{type:k,value:n}))}}))]}))},lt=n(37),jt=n.n(lt),bt=n.p+"static/media/icon-done.6d4020a5.svg",Ot=function(e){return Object(fe.jsx)("div",{className:jt.a.content,children:Object(fe.jsxs)("div",{className:jt.a.body,children:[Object(fe.jsx)("span",{className:"".concat(jt.a.orderNumber," text text_type_digits-large"),children:e.id}),Object(fe.jsx)("h2",{className:jt.a.orderTitle,children:"\u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0437\u0430\u043a\u0430\u0437\u0430"}),Object(fe.jsx)("img",{className:jt.a.icon,src:bt,alt:"Done"}),Object(fe.jsxs)("div",{className:jt.a.description,children:[Object(fe.jsx)("span",{children:"\u0412\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u043d\u0430\u0447\u0430\u043b\u0438 \u0433\u043e\u0442\u043e\u0432\u0438\u0442\u044c"}),Object(fe.jsx)("span",{className:"text_color_inactive",children:"\u0414\u043e\u0436\u0434\u0438\u0442\u0435\u0441\u044c \u0433\u043e\u0442\u043e\u0432\u043d\u043e\u0441\u0442\u0438 \u043d\u0430 \u043e\u0440\u0431\u0438\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0442\u0430\u043d\u0446\u0438\u0438"})]})]})})};var pt=function(){var e=$(),t=Object(p.g)(),n=ee((function(e){return e.user})).name,r=Object(ze.a)((function(){return{accept:"newIngredient",drop:function(e){var t=e.id;return R(t)},collect:function(e){return{isHover:e.isOver()}}}})),a=Object(b.a)(r,2),s=a[0].isHover,i=a[1],o=Object(c.useState)(!1),u=Object(b.a)(o,2),d=u[0],m=u[1],f=ee((function(e){var t;return{ingredients:e.app.ingredients,mainIngredients:(null===(t=e.burgerConstructor.currentOrder)||void 0===t?void 0:t.ingredients)||[],orderNumber:e.burgerConstructor.number}})),_=f.orderNumber,v=f.mainIngredients,y=f.ingredients,N=v.reduce((function(e,t){return e+t.price}),0),S=Object(c.useMemo)((function(){return 0===N}),[N]);Object(c.useEffect)((function(){_&&m(!0)}),[_]);var R=function(t){var n=y.find((function(e){return e._id===t}));if(n)return n.type===h.BUN?(e(Xe(n,"top")),void e(Xe(n,"bottom"))):void e(Xe(n))};return Object(fe.jsxs)("section",{ref:i,className:st.a.constructorSection,"data-test-id":"constructor",children:[S?Object(fe.jsx)("div",{className:g()(st.a.listEmpty,Object(E.a)({},st.a.listEmptyHover,s)),children:Object(fe.jsx)("span",{children:"\u041f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0441\u044e\u0434\u0430 \u0438\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u044b"})}):Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)("div",{className:st.a.list,children:v.map((function(e,t){return Object(fe.jsx)(dt,Object(te.a)({index:t},e),e.uniqueId)}))}),Object(fe.jsxs)("div",{className:st.a.constructorFooter,children:[Object(fe.jsxs)("span",{className:"".concat(st.a.cost," text text_type_digits-medium"),children:[Object(fe.jsx)("span",{className:"mr-2",children:N}),Object(fe.jsx)(O.CurrencyIcon,{type:"primary"})]}),Object(fe.jsx)(O.Button,{onClick:function(){v.length&&(n?e(function(e){return function(){var t=Object(j.a)(l.a.mark((function t(n){var r,c,a,s,i,o,u,d,j,b;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n({type:"CREATE_ORDER_REQUEST"}),r=be("accessToken"),c=localStorage.getItem("refreshToken"),r){t.next=12;break}if(!c){t.next=11;break}return t.next=8,Be(c);case 8:r=be("accessToken"),t.next=12;break;case 11:return t.abrupt("return");case 12:return a=e.map((function(e){return e.id})),s={ingredients:a},t.next=16,fetch("".concat(ge,"orders"),{method:"POST",body:JSON.stringify(s),headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}});case 16:if((i=t.sent).ok){t.next=24;break}return t.t0=JSON,t.next=21,i.text();case 21:throw t.t1=t.sent,o=t.t0.parse.call(t.t0,t.t1),new Error("Error: ".concat(i.status,", ").concat(o.message));case 24:return t.next=26,i.json();case 26:if(u=t.sent,d=u.success,j=u.order,d){t.next=31;break}throw new Error("Failed parse data");case 31:b={number:j.number,ingredients:e},n({type:C,number:b.number}),n(Ke(b)),t.next=40;break;case 36:t.prev=36,t.t2=t.catch(0),n({type:U}),t.t2 instanceof Error&&n(Ee(t.t2.message));case 40:case"end":return t.stop()}}),t,null,[[0,36]])})));return function(e){return t.apply(this,arguments)}}()}(v)):t.replace({pathname:x.LOGIN}))},children:"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437"})]})]}),d&&Object(fe.jsx)(ct,{onClose:function(){m(!1),e({type:T})},children:Object(fe.jsx)(Ot,{id:_})})]})},mt=n(114),ft=n.n(mt),_t=n(62),xt=n.n(_t),ht=Object(c.memo)((function(e){var t=$(),n=Object(p.g)(),r=Object(p.h)(),a=ee((function(t){var n,r;return(null===(n=t.burgerConstructor.currentOrder)||void 0===n||null===(r=n.ingredients.filter((function(t){return t.id===e._id})))||void 0===r?void 0:r.length)||0})),s=Object(it.a)((function(){return{type:"newIngredient",item:{id:e._id}}})),i=Object(b.a)(s,2)[1],o=Object(c.useCallback)((function(){t({type:L,ingredient:e}),t(Y(!0)),n.replace({pathname:x.INGREDIENT_VIEW.replace(/:id/,e._id),state:{modal:r}})}),[t,e,n,r]);return Object(fe.jsxs)("div",{className:g()("text text_type_main-default p-4",xt.a.ingredient),onClick:o,"data-test-id":"ingredient",children:[a>0&&Object(fe.jsx)(O.Counter,{count:a}),Object(fe.jsxs)("div",{ref:i,className:xt.a.content,children:[Object(fe.jsx)("img",{src:e.image,alt:e.name}),Object(fe.jsxs)("div",{children:[Object(fe.jsx)("span",{className:"".concat(xt.a.price," mr-3"),"data-test-id":"price",children:e.price}),Object(fe.jsx)(O.CurrencyIcon,{type:"primary"})]}),Object(fe.jsx)("div",{children:e.name})]})]})})),vt=function(e){var t=e.group;return Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)("h2",{id:t.type,children:t.name}),Object(fe.jsx)("div",{className:ft.a.ingredients,"data-test-id":"ingredientGroup",children:t.items.map((function(e){return Object(fe.jsx)(ht,Object(te.a)({},e),e._id)}))})]})},gt=n(41),Et=n.n(gt);var yt=function(){var e,t=Object(c.useState)([]),n=Object(b.a)(t,2),r=n[0],a=n[1],s=Object(c.useState)(),i=Object(b.a)(s,2),o=i[0],u=i[1],d=Object(c.useState)([{name:"\u0411\u0443\u043b\u043a\u0438",type:h.BUN,items:[]},{name:"\u0421\u043e\u0443\u0441\u044b",type:h.SAUCE,items:[]},{name:"\u041d\u0430\u0447\u0438\u043d\u043a\u0438",type:h.MAIN,items:[]}]),l=Object(b.a)(d,2),j=l[0],p=l[1],m=ee((function(e){return{ingredients:e.app.ingredients,showModal:e.detailModal.showModal}})).ingredients,f=(e={},Object(E.a)(e,h.BUN,Object(c.useRef)(null)),Object(E.a)(e,h.SAUCE,Object(c.useRef)(null)),Object(E.a)(e,h.MAIN,Object(c.useRef)(null)),e),_=Object(c.useRef)(null);return Object(c.useEffect)((function(){var e=j;m.forEach((function(t){var n=e.findIndex((function(e){return e.type===t.type}));n>=0&&e[n].items.push(t)})),p(e)}),[]),Object(c.useEffect)((function(){a(j.map((function(e){return{name:e.name,type:e.type}})))}),[j]),Object(c.useEffect)((function(){u(r[0])}),[r]),Object(fe.jsxs)("section",{className:Et.a.list,children:[Object(fe.jsx)("h1",{className:Et.a.title,children:"\u0421\u043e\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u0443\u0440\u0433\u0435\u0440"}),Object(fe.jsx)("div",{className:Et.a.tabBlock,"data-test-id":"ingredientTabs",children:r.map((function(e){return Object(fe.jsx)(O.Tab,{value:e.name,active:(t=e.type,(null===o||void 0===o?void 0:o.type)===t),onClick:function(){return function(e){var t;u(e),_.current&&(_.current.scrollTop=((null===(t=f[e.type].current)||void 0===t?void 0:t.offsetTop)||0)-259)}(e)},children:e.name},e.type);var t}))}),Object(fe.jsx)("div",{className:Et.a.tabContent,ref:_,onScroll:function(e){var t=e.currentTarget.scrollTop;t+=259;var n=Object.keys(f).map((function(e){return e})).map((function(e){var t;return{type:e,top:(null===(t=f[e].current)||void 0===t?void 0:t.offsetTop)||0}})),c=null;n.forEach((function(e){(!c&&t>=e.top||c&&t>=e.top&&t>=c.top)&&(c=e)}));var a=r.find((function(e){var t;return e.type===(null===(t=c)||void 0===t?void 0:t.type)}));a&&u(a)},children:j.map((function(e){return Object(fe.jsx)("div",{ref:f[e.type],className:Et.a.ingredientGroup,children:Object(fe.jsx)(vt,{group:e})},e.type)}))})]})},Nt=n(84),St=n.n(Nt),Rt=function(){var e=ee((function(e){return e.app})).ingredients,t=Object(c.useMemo)((function(){return(e||[]).length>0}),[e]);return Object(fe.jsx)("div",{className:St.a.container,children:Object(fe.jsx)("div",{className:St.a.body,children:t&&Object(fe.jsxs)(qe.a,{backend:Ze.a,children:[Object(fe.jsx)(yt,{}),Object(fe.jsx)(pt,{})]})})})},It=n(115),kt=n.n(It),Tt=function(){return Object(fe.jsx)("div",{className:kt.a.container,children:Object(fe.jsx)("h2",{children:"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430"})})},wt=n(116),Ct=n.n(wt);function Dt(e,t){return e.number>t.number?-1:e.number<t.number?1:0}var Lt=function(){var e=be("accessToken");Ne("orders?token=".concat(e),ye);var t=ee((function(e){return e.orderHistory.orders.sort(Dt)}));return Object(fe.jsx)(fe.Fragment,{children:Object(fe.jsx)(ve,{orders:t,className:Ct.a.orderContainer,route:x.PROFILE_ORDER_VIEW})})},Ft=n(42),Pt=n.n(Ft),Ut=function(){var e=$(),t=ee((function(e){return e.user})),n=t.email,r=t.name,a=t.password,s=Object(c.useState)({email:"",name:"",password:""}),i=Object(b.a)(s,2),o=i[0],u=i[1],d=Object(c.useCallback)((function(){u({email:n,name:r,password:a})}),[n,r,a]);Object(c.useEffect)((function(){d()}),[n,r,a,d]);var p=function(e){var t=e.target,n=t.name,r=t.value;u(Object(te.a)(Object(te.a)({},o),{},Object(E.a)({},n,r)))};return Object(fe.jsx)("div",{className:Pt.a.profile,children:Object(fe.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e(function(e){return function(){var t=Object(j.a)(l.a.mark((function t(n){var r,c,a,s,i,o,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n({type:"UPDATE_USER_REQUEST"}),r=be("accessToken"),c=localStorage.getItem("refreshToken"),r||!c){t.next=8;break}return t.next=7,Be(c);case 7:r=be("accessToken");case 8:return t.next=10,fetch("".concat(ge,"auth/user"),{method:"PATCH",body:JSON.stringify(e),headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}});case 10:if((a=t.sent).ok){t.next=16;break}return t.next=14,a.json();case 14:throw s=t.sent,new Error("Error: ".concat(s.message));case 16:return t.next=18,a.json();case 18:if(i=t.sent,o=i.success,u=i.user,o){t.next=23;break}throw new Error("Failed updating user data");case 23:n(Je(u)),t.next=30;break;case 26:t.prev=26,t.t0=t.catch(0),n({type:"UPDATE_USER_ERROR"}),t.t0 instanceof Error&&n(Ee(t.t0.message));case 30:case"end":return t.stop()}}),t,null,[[0,26]])})));return function(e){return t.apply(this,arguments)}}()}(o))},children:[Object(fe.jsx)("div",{className:Pt.a.input,children:Object(fe.jsx)(O.Input,{onChange:p,value:o.name,name:"name",placeholder:"\u0418\u043c\u044f"})}),Object(fe.jsx)("div",{className:Pt.a.input,children:Object(fe.jsx)(O.EmailInput,{onChange:p,value:o.email,name:"email"})}),Object(fe.jsx)("div",{className:Pt.a.input,children:Object(fe.jsx)(O.PasswordInput,{onChange:p,value:o.password,name:"password"})}),Object(fe.jsxs)("div",{className:Pt.a.actions,children:[Object(fe.jsx)(O.Button,{type:"primary",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),Object(fe.jsx)(O.Button,{type:"secondary",onClick:function(e){e.preventDefault(),d()},children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"})]})]})})},Gt=n(86),At=n.n(Gt),Mt=function(){var e=$(),t=Object(p.g)();return Object(fe.jsxs)("aside",{children:[Object(fe.jsxs)("ul",{children:[Object(fe.jsx)("li",{children:Object(fe.jsx)(u.c,{to:x.PROFILE,activeClassName:At.a.activeLink,exact:!0,children:Object(fe.jsx)("h2",{children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"})})}),Object(fe.jsx)("li",{children:Object(fe.jsx)(u.c,{to:x.PROFILE_ORDER_LIST,activeClassName:At.a.activeLink,exact:!0,children:Object(fe.jsx)("h2",{children:"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u043e\u0432"})})}),Object(fe.jsx)("li",{onClick:function(){var n,r=localStorage.getItem("refreshToken");r&&(e((n=r,function(){var e=Object(j.a)(l.a.mark((function e(t){var r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:"LOGOUT_REQUEST"}),e.next=4,fetch("".concat(ge,"auth/logout"),{method:"POST",body:JSON.stringify({token:n}),headers:{"Content-Type":"application/json"}});case 4:if((r=e.sent).ok){e.next=10;break}return e.next=8,r.json();case 8:throw c=e.sent,new Error("Error: ".concat(c.message));case 10:return e.next=12,r.json();case 12:if(e.sent.success){e.next=16;break}throw new Error("Failed logout");case 16:Me(),t({type:X}),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(0),t({type:"LOGOUT_ERROR"}),e.t0 instanceof Error&&t(Ee(e.t0.message));case 24:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(t){return e.apply(this,arguments)}}())),t.replace({pathname:x.LOGIN}))},children:Object(fe.jsx)("h2",{children:"\u0412\u044b\u0445\u043e\u0434"})})]}),Object(fe.jsx)("span",{className:g()("text_color_inactive"),children:"\u0412 \u044d\u0442\u043e\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0435 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0432\u043e\u0438 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435"})]})},Bt=n(117),Wt=n.n(Bt),Ht=function(){var e=Object(p.h)();return Object(fe.jsxs)("div",{className:Wt.a.container,children:[Object(fe.jsx)(Mt,{}),Object(fe.jsxs)(p.d,{location:e,children:[Object(fe.jsx)(p.b,{path:x.PROFILE,component:Ut,exact:!0}),Object(fe.jsx)(p.b,{path:x.PROFILE_ORDER_LIST,component:Lt,exact:!0})]})]})},Vt=function(){var e=$(),t=Object(c.useState)({email:"",password:"",name:""}),n=Object(b.a)(t,2),r=n[0],a=n[1],s=function(e){var t=e.target,n=t.name,c=t.value;a(Object(te.a)(Object(te.a)({},r),{},Object(E.a)({},n,c)))};return Object(fe.jsx)("div",{className:De.a.container,children:Object(fe.jsxs)("div",{className:De.a.login,children:[Object(fe.jsx)("div",{className:"text_type_main-medium",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(fe.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e(function(e){return function(){var t=Object(j.a)(l.a.mark((function t(n){var r,c,a,s,i,o,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n({type:"SIGNUP_REQUEST"}),t.next=4,fetch("".concat(ge,"auth/register"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});case 4:if((r=t.sent).ok){t.next=10;break}return t.next=8,r.json();case 8:throw c=t.sent,new Error("Error: ".concat(c.message));case 10:return t.next=12,r.json();case 12:if(a=t.sent,s=a.success,i=a.user,o=a.refreshToken,u=a.accessToken,s){t.next=19;break}throw new Error("Failed signup");case 19:Ae(u,o),n(He(i)),t.next=27;break;case 23:t.prev=23,t.t0=t.catch(0),n({type:"SIGNUP_ERROR"}),t.t0 instanceof Error&&n(Ee(t.t0.message));case 27:case"end":return t.stop()}}),t,null,[[0,23]])})));return function(e){return t.apply(this,arguments)}}()}(r))},children:[Object(fe.jsx)("div",{className:De.a.input,children:Object(fe.jsx)(O.Input,{placeholder:"\u0418\u043c\u044f",onChange:s,value:r.name,name:"name"})}),Object(fe.jsx)("div",{className:De.a.input,children:Object(fe.jsx)(O.EmailInput,{onChange:s,value:r.email,name:"email"})}),Object(fe.jsx)("div",{className:De.a.input,children:Object(fe.jsx)(O.PasswordInput,{onChange:s,value:r.password,name:"password"})}),Object(fe.jsx)("div",{className:De.a.btnLogin,children:Object(fe.jsx)(O.Button,{type:"primary",size:"large",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})})]}),Object(fe.jsxs)("div",{className:De.a.firstLine,children:[Object(fe.jsx)("span",{children:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"}),Object(fe.jsx)(u.b,{to:x.LOGIN,children:"\u0412\u043e\u0439\u0442\u0438"})]})]})})},Jt=function(){var e=$(),t=Object(p.g)(),n=Object(p.h)().state,r=ee((function(e){return e.resetPassword})).isSendForgotPassword,a=Object(c.useState)({password:"",token:""}),s=Object(b.a)(a,2),i=s[0],o=s[1],d=function(e){o(Object(te.a)(Object(te.a)({},i),{},Object(E.a)({},e.target.name,e.target.value)))},m=function(){var n=Object(j.a)(l.a.mark((function n(r){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.preventDefault(),n.next=3,e(we(i));case 3:t.replace({pathname:x.LOGIN});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return Object(c.useEffect)((function(){r||n||t.replace({pathname:x.FORGOT_PASSWORD})}),[r,t,n]),Object(fe.jsx)("div",{className:De.a.container,children:Object(fe.jsxs)("div",{className:De.a.login,children:[Object(fe.jsx)("div",{className:"text_type_main-medium",children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f"}),Object(fe.jsxs)("form",{onSubmit:m,children:[Object(fe.jsx)("div",{className:De.a.input,children:Object(fe.jsx)(O.PasswordInput,{onChange:d,value:i.password,name:"password"})}),Object(fe.jsx)("div",{className:De.a.input,children:Object(fe.jsx)(O.Input,{onChange:d,value:i.token,name:"token",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434 \u0438\u0437 \u043f\u0438\u0441\u044c\u043c\u0430"})}),Object(fe.jsx)("div",{className:De.a.btnLogin,children:Object(fe.jsx)(O.Button,{type:"primary",size:"large",children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c"})})]}),Object(fe.jsxs)("div",{className:De.a.firstLine,children:[Object(fe.jsx)("span",{children:"\u0412\u0441\u043f\u043e\u043c\u043d\u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?"}),Object(fe.jsx)(u.b,{to:x.LOGIN,children:"\u0412\u043e\u0439\u0442\u0438"})]})]})})},Qt=n(25),qt=n.n(Qt),Zt=function(){var e=$(),t=Object(p.i)(),n=ee((function(e){return e.orderHistory.current})),r=ee((function(e){var t,n=(null===(t=e.orderHistory.current)||void 0===t?void 0:t.ingredients.map((function(t){return e.app.ingredients.find((function(e){return e._id===t}))})))||[],r=[];return n.forEach((function(e){var t=r.findIndex((function(t){return t._id===e._id}));-1===t?r.push(Object(te.a)(Object(te.a)({},e),{},{qty:1})):r[t].qty+=1})),r})),a=Object(c.useMemo)((function(){return!!n&&f[n.status]===f.done}),[n]),s=Object(c.useMemo)((function(){return n?Oe(n.createdAt):""}),[n]),i=Object(c.useMemo)((function(){return r.reduce((function(e,t){return e+t.qty*t.price}),0)}),[r]);return Object(c.useEffect)((function(){var n;e((n=t.id,function(){var e=Object(j.a)(l.a.mark((function e(t){var r,c,a,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:"SET_ORDER_REQUEST"}),e.next=4,fetch("".concat(ge,"orders/").concat(n));case 4:if((r=e.sent).ok){e.next=12;break}return e.t0=JSON,e.next=9,r.text();case 9:throw e.t1=e.sent,c=e.t0.parse.call(e.t0,e.t1),new Error("Error: ".concat(r.status,", ").concat(c.message));case 12:return e.next=14,r.json();case 14:if(a=e.sent,s=a.success,i=a.orders,s&&!(i.length>1)){e.next=19;break}throw new Error("Failed parse data");case 19:t((o=i[0],{type:A,current:o})),e.next=26;break;case 22:e.prev=22,e.t2=e.catch(0),t({type:"SET_ORDER_FAILED"}),e.t2 instanceof Error&&t(Ee(e.t2.message));case 26:case"end":return e.stop()}var o}),e,null,[[0,22]])})));return function(t){return e.apply(this,arguments)}}()))}),[e,t.id]),n?Object(fe.jsxs)("div",{className:qt.a.orderDetail,children:[Object(fe.jsxs)("div",{className:g()(qt.a.orderNumber,"text","text_type_digits-default"),children:["#",n.number]}),Object(fe.jsxs)("div",{className:qt.a.orderName,children:[Object(fe.jsx)("h2",{children:n.name}),Object(fe.jsx)("span",{className:g()(Object(E.a)({},qt.a.done,a)),children:f[n.status]})]}),Object(fe.jsxs)("div",{className:qt.a.receipt,children:[Object(fe.jsx)("h2",{children:"\u0421\u043e\u0441\u0442\u0430\u0432:"}),Object(fe.jsx)("div",{className:qt.a.container,children:r.map((function(e,t){return Object(fe.jsxs)("div",{className:qt.a.ingredient,children:[Object(fe.jsx)("div",{className:qt.a.imgBlock,children:Object(fe.jsx)("img",{src:e.image_mobile,alt:e.name})}),Object(fe.jsx)("span",{className:qt.a.ingredientName,children:e.name}),Object(fe.jsxs)("span",{className:g()(qt.a.price,"text","text_type_digits-default"),children:[Object(fe.jsxs)("span",{children:[e.qty," x ",e.price]}),Object(fe.jsx)(O.CurrencyIcon,{type:"primary"})]})]},"".concat(e._id,"-").concat(t))}))})]}),Object(fe.jsxs)("div",{className:qt.a.footer,children:[Object(fe.jsx)("span",{className:g()("text","text_type_main-default","text_color_inactive"),children:s}),Object(fe.jsxs)("span",{className:g()(qt.a.price,"text","text_type_digits-default"),children:[Object(fe.jsx)("span",{children:i}),Object(fe.jsx)(O.CurrencyIcon,{type:"primary"})]})]})]}):Object(fe.jsx)(fe.Fragment,{})},zt=function(){return Object(fe.jsx)(fe.Fragment,{children:Object(fe.jsx)(Zt,{})})};var Xt=function(){var e=Object(p.g)(),t=Object(p.h)();return t.state&&t.state.modal?Object(fe.jsx)(ct,{onClose:function(){e.replace({pathname:x.MAIN})},children:Object(fe.jsx)(Ue,{})}):Object(fe.jsx)(fe.Fragment,{})},Kt=n(121),Yt=["children"],$t=function(e){var t=e.children,n=Object(Kt.a)(e,Yt),r=ee((function(e){return e.user}));return Object(fe.jsx)(p.b,Object(te.a)(Object(te.a)({},n),{},{render:function(e){var n=e.location;return r.name?t:Object(fe.jsx)(p.a,{to:{pathname:x.LOGIN,state:{from:n}}})}}))},en=n(19),tn=n.n(en);var nn=function(){return Object(fe.jsx)("header",{className:tn.a.header,children:Object(fe.jsxs)("nav",{className:tn.a.nav,children:[Object(fe.jsx)("div",{className:tn.a.item,children:Object(fe.jsxs)(u.c,{to:x.MAIN,activeClassName:tn.a.activeLink,className:g()(tn.a.link,"text_color_inactive"),exact:!0,children:[Object(fe.jsx)(O.BurgerIcon,{type:"secondary"}),Object(fe.jsx)("span",{children:"\u041a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440"})]})}),Object(fe.jsx)("div",{className:tn.a.item,children:Object(fe.jsxs)(u.c,{to:x.FEED,activeClassName:tn.a.activeLink,className:g()(tn.a.link,"text_color_inactive"),exact:!0,children:[Object(fe.jsx)(O.ListIcon,{type:"secondary"}),Object(fe.jsx)("span",{children:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432"})]})}),Object(fe.jsx)("div",{className:"".concat(tn.a.logo," ").concat(tn.a.item),children:Object(fe.jsx)(u.c,{to:x.MAIN,children:Object(fe.jsx)(O.Logo,{})})}),Object(fe.jsx)("div",{className:tn.a.item,children:Object(fe.jsxs)(u.c,{to:x.PROFILE,activeClassName:tn.a.activeLink,className:g()(tn.a.link,"text_color_inactive"),exact:!0,children:[Object(fe.jsx)(O.ProfileIcon,{type:"secondary"}),Object(fe.jsx)("span",{children:"\u041b\u0438\u0447\u043d\u044b\u0439 \u043a\u0430\u0431\u0438\u043d\u0435\u0442"})]})})]})})},rn=function(){var e=Object(p.g)(),t=Object(p.h)();return t.state&&t.state.modal?Object(fe.jsx)(ct,{onClose:function(){var n=t.pathname.split("/"),r=n.slice(0,n.length-1).join("/");e.replace({pathname:r})},children:Object(fe.jsx)(Zt,{})}):Object(fe.jsx)(fe.Fragment,{})},cn=n(118),an=n.n(cn),sn=function(){var e=$(),t=Object(p.g)(),n=Object(p.h)(),r=Object(c.useState)(!1),a=Object(b.a)(r,2),s=a[0],i=a[1],o=ee((function(e){return e.user})).name,u=ee((function(e){return e.app})),d=u.error,m=u.ingredients,f=Object(c.useMemo)((function(){return(m||[]).length>0}),[m]),_=function(){var t=Object(j.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o){t.next=3;break}return t.next=3,e(function(){var e=Object(j.a)(l.a.mark((function e(t){var n,r,c,a,s,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t({type:"FETCH_USER_REQUEST"}),n=be("accessToken"),r=localStorage.getItem("refreshToken"),n){e.next=12;break}if(!r){e.next=11;break}return e.next=8,Be(r);case 8:n=be("accessToken"),e.next=12;break;case 11:return e.abrupt("return");case 12:return e.next=14,fetch("".concat(ge,"auth/user"),{headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}});case 14:if((c=e.sent).ok){e.next=20;break}return e.next=18,c.json();case 18:throw a=e.sent,new Error(a.message);case 20:return e.next=22,c.json();case 22:if(s=e.sent,i=s.success,o=s.user,i){e.next=27;break}throw new Error("Failed fetching user data");case 27:t(Ve(o)),e.next=34;break;case 30:e.prev=30,e.t0=e.catch(0),t({type:"FETCH_USER_ERROR"}),e.t0 instanceof Error&&t(Ee(e.t0.message));case 34:case"end":return e.stop()}}),e,null,[[0,30]])})));return function(t){return e.apply(this,arguments)}}());case 3:f||e(function(){var e=Object(j.a)(l.a.mark((function e(t){var n,r,c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:"FETCH_INGREDIENTS_REQUEST"}),e.next=4,fetch("".concat(ge,"ingredients"));case 4:if((n=e.sent).ok){e.next=7;break}throw new Error("Error: ".concat(n.status));case 7:return e.next=9,n.json();case 9:if(r=e.sent,c=r.success,a=r.data,c){e.next=14;break}throw new Error("Failed parse data");case 14:t({type:N,ingredients:a}),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),t({type:S}),e.t0 instanceof Error&&t(Ee(e.t0.message));case 21:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(t){return e.apply(this,arguments)}}()),i(!0);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();Object(c.useEffect)((function(){_()}),[]),Object(c.useEffect)((function(){var e=[x.LOGIN,x.SIGNUP,x.FORGOT_PASSWORD,x.RESET_PASSWORD];o&&e.includes(n.pathname)&&t.replace({pathname:x.MAIN})}),[o,t,n.pathname]);var h=n.state&&n.state.modal;return s?Object(fe.jsxs)("div",{className:"text_type_main-default",children:[Object(fe.jsx)(nn,{}),Object(fe.jsxs)("main",{className:an.a.container,children:[d&&Object(fe.jsxs)("div",{className:"alertDanger",children:[Object(fe.jsx)("span",{className:"errorMessage",children:d}),Object(fe.jsx)(O.CloseIcon,{type:"primary",onClick:function(){return e({type:R})}})]}),Object(fe.jsxs)(p.d,{location:null!==h&&void 0!==h?h:n,children:[Object(fe.jsx)(p.b,{path:x.LOGIN,component:Qe,exact:!0}),Object(fe.jsx)(p.b,{path:x.SIGNUP,component:Vt,exact:!0}),Object(fe.jsx)(p.b,{path:x.FORGOT_PASSWORD,component:Le,exact:!0}),Object(fe.jsx)(p.b,{path:x.RESET_PASSWORD,component:Jt,exact:!0}),Object(fe.jsx)(p.b,{path:x.FEED,component:Te,exact:!0}),Object(fe.jsx)(p.b,{path:x.FEED_VIEW,component:zt,exact:!0}),Object(fe.jsx)(p.b,{path:x.MAIN,component:Rt,exact:!0}),Object(fe.jsx)(p.b,{path:x.INGREDIENT_VIEW,component:Ge,exact:!0}),Object(fe.jsx)($t,{path:x.PROFILE_ORDER_VIEW,exact:!0,children:Object(fe.jsx)(zt,{})}),Object(fe.jsx)($t,{path:x.PROFILE,children:Object(fe.jsx)(Ht,{})}),Object(fe.jsx)($t,{path:x.PROFILE_ORDER_LIST,exact:!0,children:Object(fe.jsx)(Lt,{})}),Object(fe.jsx)(p.b,{component:Tt})]}),h&&Object(fe.jsx)(p.b,{path:x.INGREDIENT_VIEW,component:Xt,exact:!0}),h&&Object(fe.jsx)(p.b,{path:x.FEED_VIEW,component:rn,exact:!0}),h&&Object(fe.jsx)($t,{path:x.PROFILE_ORDER_VIEW,exact:!0,children:Object(fe.jsx)(rn,{})})]})]}):null},on=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,222)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))},un=n(31),dn=n(119),ln={error:null,ingredients:[]},jn=n(59),bn={currentOrder:null},On={showModal:!1,ingredient:null},pn={orders:[]},mn={orders:[]},fn={isSendForgotPassword:!1},_n={isConnected:!1},xn={email:"",name:"",password:""},hn=Object(un.b)({app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return Object(te.a)(Object(te.a)({},e),{},{error:t.error});case N:return Object(te.a)(Object(te.a)({},e),{},{ingredients:t.ingredients});case S:return ln;case R:return Object(te.a)(Object(te.a)({},e),{},{error:null});default:return e}},burgerConstructor:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:return bn;case I:var n=t.value;if(!e.currentOrder)return Object(te.a)(Object(te.a)({},e),{},{currentOrder:{ingredients:[n]}});var r=e.currentOrder.ingredients,c=n.type===h.BUN,a=r.some((function(e){return e.type===h.BUN}));if(c){var s=(r=r.map((function(e){return e.position===n.position&&e.type===n.type?n:e}))).some((function(e){return e.position===n.position&&e.type===n.type}));if(!s){var i="top"===n.position;i?r.splice(0,0,n):r.push(n)}}else r.splice(a?r.length-1:r.length,0,n);return Object(te.a)(Object(te.a)({},e),{},{currentOrder:{ingredients:r}});case k:var o=function(){if(!e.currentOrder)return e;var n=e.currentOrder.ingredients;return Object(te.a)(Object(te.a)({},e),{},{currentOrder:{ingredients:n.filter((function(e){return e.uniqueId!==t.value}))}})};return o();case w:var u=function(){if(!e.currentOrder)return e;var n=t.dragIndex,r=t.hoverIndex,c=Object(jn.a)(e.currentOrder.ingredients),a=c[n];return c.splice(n,1),c.splice(r,0,a),Object(te.a)(Object(te.a)({},e),{},{currentOrder:{ingredients:c}})};return u();case C:return Object(te.a)(Object(te.a)({},e),{},{number:t.number});default:return e}},detailModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:On,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return Object(te.a)(Object(te.a)({},e),{},{showModal:t.value});case L:return Object(te.a)(Object(te.a)({},e),{},{ingredient:t.ingredient});case F:return Object(te.a)(Object(te.a)({},e),{},{ingredient:null});default:return e}},order:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case P:var n=t.order;return Object(te.a)(Object(te.a)({},e),{},{orders:[].concat(Object(jn.a)(e.orders),[n])});case U:return pn;default:return e}},orderHistory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case G:return Object(te.a)(Object(te.a)({},e),{},{orders:t.data.orders,total:t.data.total,totalToday:t.data.totalToday});case A:return Object(te.a)(Object(te.a)({},e),{},{current:t.current});default:return e}},resetPassword:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:return Object(te.a)(Object(te.a)({},e),{},{isSendForgotPassword:!0});case W:case B:case H:return fn;default:return e}},socketReducer:function(e,t){switch(t.type){case V:return{isConnected:!0};case J:return{isConnected:!1};default:return _n}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Z:case K:case Q:case q:return Object(te.a)(Object(te.a)({},e),t.user);case z:case X:return xn;default:return e}}}),vn=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):un.c)(Object(un.a)(dn.a)),gn=Object(un.d)(hn,vn);i.a.render(Object(fe.jsx)(a.a.StrictMode,{children:Object(fe.jsx)(u.a,{children:Object(fe.jsx)(o.a,{store:gn,children:Object(fe.jsx)(sn,{})})})}),document.getElementById("root")),on()},24:function(e,t,n){e.exports={order:"order-short_order__2Qo8F",header:"order-short_header__3nmlR",created:"order-short_created__3UJDF",title:"order-short_title__1xV5z",done:"order-short_done__3sTl8",receipt:"order-short_receipt__3iM3T",ingredients:"order-short_ingredients__22kN1",imgBlock:"order-short_imgBlock__1LvpG",more:"order-short_more__1PNGn",cost:"order-short_cost__1OtEa"}},25:function(e,t,n){e.exports={container:"order-detail_container__4ygnl",orderDetail:"order-detail_orderDetail__3bA_C",orderNumber:"order-detail_orderNumber__1VfAZ",orderName:"order-detail_orderName__FYDgD",done:"order-detail_done__1AgXA",receipt:"order-detail_receipt__ic_5y",imgBlock:"order-detail_imgBlock__3UmKv",ingredient:"order-detail_ingredient__1wX8Z",ingredientName:"order-detail_ingredientName__3h4a1",price:"order-detail_price__1P6ny",footer:"order-detail_footer__8TGU5"}},27:function(e,t,n){e.exports={feed:"feed_feed__3qXwX",orderList:"feed_orderList__d5DMQ",stats:"feed_stats__2asQ0",ordersByStatus:"feed_ordersByStatus__kqnOO",numberList:"feed_numberList__jvDHZ",done:"feed_done__i9bek",counter:"feed_counter__2Zl3l",counterTitle:"feed_counterTitle__XKNKO"}},29:function(e,t,n){e.exports={body:"ingredient-details_body__3Gr9B",imgBlock:"ingredient-details_imgBlock__VyKuR",name:"ingredient-details_name__yivka",composition:"ingredient-details_composition__3yAjI",compositionItem:"ingredient-details_compositionItem__ICZ8O",compositionValue:"ingredient-details_compositionValue__33O2h",content:"ingredient-details_content__2oxBJ",header:"ingredient-details_header__2KIpI",page:"ingredient-details_page__1wQfY"}},36:function(e,t,n){e.exports={constructorSection:"burger-constructor_constructorSection__331_b",list:"burger-constructor_list__2e3gb",listEmpty:"burger-constructor_listEmpty__253Y6",listEmptyHover:"burger-constructor_listEmptyHover__2dEjR",firstItem:"burger-constructor_firstItem__3MQp5",lastItem:"burger-constructor_lastItem__kZjeK",cost:"burger-constructor_cost__JRzNu",constructorFooter:"burger-constructor_constructorFooter__3xeG6"}},37:function(e,t,n){e.exports={content:"order-details_content__20Pzk",body:"order-details_body__P_0Ub",orderNumber:"order-details_orderNumber__21Dhu",orderTitle:"order-details_orderTitle__21BCp",icon:"order-details_icon__1E-Q_",description:"order-details_description__fl1LJ"}},41:function(e,t,n){e.exports={list:"burger-ingredients_list__2qHfU",tabBlock:"burger-ingredients_tabBlock__3kPRr",tabContent:"burger-ingredients_tabContent__2QSfk",ingredientGroup:"burger-ingredients_ingredientGroup__2rWOF",title:"burger-ingredients_title__25UcL"}},42:function(e,t,n){e.exports={profile:"edit-profile_profile__2cmbn",input:"edit-profile_input__2uJfY",actions:"edit-profile_actions__jL5bh"}},44:function(e,t,n){},50:function(e,t,n){e.exports={modal:"modal_modal__2LGpc",modalDialog:"modal_modalDialog__16ZDq",modalContent:"modal_modalContent__2COXU",closeButton:"modal_closeButton__3_1tk"}},61:function(e,t,n){e.exports={item:"item_item__2emh7",bun:"item_bun__2S9Jf",icon:"item_icon__3xT9M"}},62:function(e,t,n){e.exports={ingredient:"ingredient_ingredient__1lfUI",price:"ingredient_price__1dGwZ",content:"ingredient_content__ixDzt"}},8:function(e,t,n){e.exports={container:"login_container__3BdxE",login:"login_login__1IIqf",input:"login_input__3KY-6",btnLogin:"login_btnLogin__jAaCC",firstLine:"login_firstLine__1n6lT",secondLine:"login_secondLine__8h48E"}},84:function(e,t,n){e.exports={container:"main_container__2UF3P",body:"main_body__2xhbC"}},86:function(e,t,n){e.exports={activeLink:"sidebar_activeLink__1LZdF"}}},[[212,1,2]]]);
//# sourceMappingURL=main.610929bd.chunk.js.map